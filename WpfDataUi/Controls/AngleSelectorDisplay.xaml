<UserControl
    x:Class="WpfDataUi.Controls.AngleSelectorDisplay"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:conv="clr-namespace:WpfDataUi.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:decorators="clr-namespace:WpfDataUiCore.Decorators"
    xmlns:local="clr-namespace:WpfDataUi.Controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">
    <UserControl.Resources>
        <conv:AddDoubleConverter x:Key="AddDoubleConverter" />
    </UserControl.Resources>
    <StackPanel>

        <Grid
            x:Name="TopRowGrid"
            DragOver="Grid_DragOver_1"
            PreviewMouseUp="TopRowGrid_PreviewMouseUp">
            <Grid.ContextMenu>
                <ContextMenu />
            </Grid.ContextMenu>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>

            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <Label
                x:Name="Label"
                Grid.Column="0"
                VerticalAlignment="Center">
                TitleText
            </Label>
            <Canvas
                x:Name="CanvasInstance"
                Grid.Column="1"
                Width="40"
                Height="40"
                Margin="6">
                <Ellipse
                    x:Name="EllipseInstance"
                    Grid.Column="0"
                    Width="40"
                    Height="40"
                    MouseDown="Ellipse_MouseDown"
                    MouseLeftButtonDown="Ellipse_MouseLeftButtonDown_1"
                    MouseMove="Ellipse_MouseMove_1"
                    MouseUp="Ellipse_MouseUp"
                    Stroke="Gray">
                    <Ellipse.Fill>
                        <LinearGradientBrush StartPoint=".5,0" EndPoint=".5,1">
                            <GradientStop Offset="0.0" Color="White" />
                            <GradientStop Offset="1.0" Color="LightGray" />
                        </LinearGradientBrush>
                    </Ellipse.Fill>
                </Ellipse>
                <Line
                    x:Name="Line"
                    Canvas.Left="20"
                    Canvas.Top="20"
                    MouseMove="Ellipse_MouseMove_1"
                    RenderTransformOrigin="0,0"
                    StrokeEndLineCap="Triangle"
                    StrokeThickness="3"
                    X1="0"
                    X2="22"
                    Y1="0"
                    Y2="0">
                    <Line.RenderTransform>
                        <TransformGroup>
                            <ScaleTransform />
                            <SkewTransform />
                            <RotateTransform Angle="{Binding Path=NegativeAngle}" />
                            <TranslateTransform />
                        </TransformGroup>
                    </Line.RenderTransform>
                    <Line.Stroke>
                        <SolidColorBrush Color="Black" />


                    </Line.Stroke>

                </Line>
                <Ellipse
                    Name="CenterPoint"
                    Grid.Column="0"
                    Canvas.Left="18"
                    Canvas.Top="18"
                    Width="4"
                    Height="4"
                    Fill="Gray" />

            </Canvas>
            <Grid Grid.Column="2">
                <Grid>
                    <TextBox
                        x:Name="TextBox"
                        MinWidth="30"
                        Margin="0,0,13,0"
                        VerticalAlignment="Center"
                        LostFocus="TextBox_LostFocus_1"
                        PreviewKeyDown="TextBox_PreviewKeyDown_1">
                        <TextBox.ContextMenu>
                            <ContextMenu />
                        </TextBox.ContextMenu>
                    </TextBox>
                    <decorators:NoSizeDecorator>
                        <TextBlock
                            x:Name="PlaceholderText"
                            Margin="3,0,16,0"
                            VerticalAlignment="Center"
                            Foreground="Gray"
                            IsHitTestVisible="False" />
                    </decorators:NoSizeDecorator>
                </Grid>
                <Label
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    Content="&#186;" />
            </Grid>
        </Grid>
        <TextBlock
            x:Name="HintTextBlock"
            Grid.Row="2"
            Grid.ColumnSpan="3"
            MaxWidth="{Binding ActualWidth, ElementName=TopRowGrid}"
            Margin="0,0,-4,0"
            Padding="8,1,0,4"
            HorizontalAlignment="Left"
            VerticalAlignment="Top"
            FontSize="{Binding Path=FontSize, RelativeSource={RelativeSource AncestorType={x:Type local:AngleSelectorDisplay}}, Converter={StaticResource AddDoubleConverter}, ConverterParameter=-2}"
            Text="This is a property description. But what if it is longer?"
            TextWrapping="Wrap" />

    </StackPanel>
</UserControl>
