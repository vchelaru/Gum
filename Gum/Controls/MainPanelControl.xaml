<UserControl
  x:Class="Gum.Controls.MainPanelControl"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:behaviors="clr-namespace:Gum.Behaviors"
  xmlns:converters="clr-namespace:Gum.Converters"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:local="clr-namespace:Gum.Controls"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  d:DataContext="{d:DesignInstance Type=local:MainPanelViewModel}"
  d:DesignHeight="450"
  d:DesignWidth="800"
  mc:Ignorable="d">
  <UserControl.Resources>
    <ResourceDictionary>
      <converters:GridLengthToDoubleConverter x:Key="GridLengthConverter" />
      <Style BasedOn="{StaticResource {x:Type GridSplitter}}" TargetType="{x:Type GridSplitter}">
        <Setter Property="Background" Value="{StaticResource Frb.Brushes.Border}" />
        <Setter Property="Panel.ZIndex" Value="10" />
        <Style.Triggers>
          <Trigger Property="HorizontalAlignment" Value="Stretch">
            <Setter Property="BorderThickness" Value="0,4" />
            <Setter Property="BorderBrush" Value="Transparent" />
            <Setter Property="Margin" Value="0,-4" />
          </Trigger>
          <Trigger Property="VerticalAlignment" Value="Stretch">
            <Setter Property="BorderThickness" Value="4,0" />
            <Setter Property="BorderBrush" Value="Transparent" />
            <Setter Property="Margin" Value="-4,0" />
          </Trigger>
        </Style.Triggers>
      </Style>
      <!--  When CustomHeaderContent exists, just present it  -->
      <DataTemplate x:Key="TabCustomHeaderTemplate">
        <ContentPresenter Content="{Binding CustomHeaderContent}" />
      </DataTemplate>

      <!--  Fallback to Title on the TabItem's DataContext  -->
      <DataTemplate x:Key="TabTitleHeaderTemplate">
        <TextBlock Text="{Binding Title}" />
      </DataTemplate>

      <local:PluginTabHeaderTemplateSelector
        x:Key="PluginTabHeaderSelector"
        CustomHeaderTemplate="{StaticResource TabCustomHeaderTemplate}"
        TitleHeaderTemplate="{StaticResource TabTitleHeaderTemplate}" />

      <Style
        x:Key="PluginTabStyle"
        BasedOn="{StaticResource {x:Type TabItem}}"
        TargetType="{x:Type TabItem}">
        <Setter Property="IsSelected" Value="{Binding IsSelected, Mode=TwoWay}" />
        <Setter Property="HeaderTemplateSelector" Value="{StaticResource PluginTabHeaderSelector}" />

        <Setter Property="ContentTemplate">
          <Setter.Value>
            <DataTemplate>
              <ContentPresenter Content="{Binding Content}" />
            </DataTemplate>
          </Setter.Value>
        </Setter>

        <EventSetter Event="MouseDown" Handler="TabHeader_OnMiddleMouseDown" />
      </Style>

      <Style
        x:Key="PluginTabControlStyle"
        BasedOn="{StaticResource {x:Type TabControl}}"
        TargetType="{x:Type TabControl}">
        <Setter Property="ItemContainerStyle" Value="{StaticResource PluginTabStyle}" />
      </Style>
      <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/Themes/MainPanelControl.Styles.xaml" />
      </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
  </UserControl.Resources>
  <Grid behaviors:GridDefinitionSync.Enable="True">
    <Grid.ColumnDefinitions>
      <ColumnDefinition x:Name="LeftColumn" Width="{Binding LeftColumnWidth, Mode=TwoWay, Converter={StaticResource GridLengthConverter}}" />
      <ColumnDefinition x:Name="LeftSplitter" Width="Auto" />
      <ColumnDefinition x:Name="MiddleColumn" Width="{Binding CenterColumnWidth, Mode=TwoWay, Converter={StaticResource GridLengthConverter}}" />
      <ColumnDefinition x:Name="MiddleSplitter" Width="Auto" />
      <ColumnDefinition x:Name="RightColumn" Width="*" />
    </Grid.ColumnDefinitions>


    <Grid x:Name="CenterGrid" Grid.Column="2">
      <Grid.RowDefinitions>
        <RowDefinition Height="1*" />
        <RowDefinition Height="Auto" />
        <RowDefinition Height="2*" />
      </Grid.RowDefinitions>

      <TabControl
        x:Name="CenterTopTabControl"
        Grid.Row="0"
        ItemsSource="{Binding CenterTopView}"
        Style="{StaticResource MainTabControl.Style}" />

      <GridSplitter
        Grid.Row="1"
        HorizontalAlignment="Stretch"
        VerticalAlignment="Center" />


      <TabControl
        x:Name="CenterBottomTabControl"
        Grid.Row="2"
        ItemsSource="{Binding CenterBottomView}"
        Style="{StaticResource MainTabControl.Style}" />

    </Grid>

    <Grid
      x:Name="RightGrid"
      Grid.Column="4"
      behaviors:GridDefinitionSync.Enable="True">
      <Grid.RowDefinitions>
        <RowDefinition Height="*" />
        <RowDefinition x:Name="BottomRightSplitter" Height="Auto" />
        <RowDefinition x:Name="BottomRightPanel" Height="{Binding BottomRightHeight, Mode=TwoWay, Converter={StaticResource GridLengthConverter}}" />
      </Grid.RowDefinitions>

      <TabControl
        x:Name="RightTopTabControl"
        Grid.Row="0"
        ItemsSource="{Binding RightTopView}"
        Style="{StaticResource MainTabControl.Style}" />


      <TabControl
        x:Name="RightBottomTabControl"
        Grid.Row="2"
        ItemsSource="{Binding RightBottomView}"
        SelectedItem="{Binding LeftView.CurrentItem, Mode=OneWay}"
        Style="{StaticResource MainTabControl.Style}" />
      <GridSplitter
        Grid.Row="1"
        HorizontalAlignment="Stretch"
        VerticalAlignment="Center" />
    </Grid>

    <TabControl
      x:Name="LeftTabControl"
      Grid.Row="0"
      ItemsSource="{Binding LeftView}"
      Style="{StaticResource MainTabControl.Style}" />
    <GridSplitter
      Grid.Column="1"
      HorizontalAlignment="Center"
      VerticalAlignment="Stretch" />

    <GridSplitter
      Grid.Column="3"
      HorizontalAlignment="Center"
      VerticalAlignment="Stretch" />
  </Grid>
</UserControl>
